# 자바스크립트 스코프 체인과 즉시 실행 함수

## 스코프 체인
스코프 체인이란 자신의 스코프에서 참조할 변수를 찾고 없으면 한단계씩 올라가 결국 전역 스코프까지 꼬리를 물고 찾아가는 관계를 말한다.

```js
function c() {
    console.log('c');
    function b() {
        console.log('b');
        c();
    }
}

function a() {
    console.log('a');
    b();
}

b(); // error
```

c -> anonymous<br/>
a -> anonymous<br/>
b -> c -> anonymous
<br/>

위의 예시에서 anonymous란 전역 스코프를 말한다.<br/>
a 함수와 c 함수는 전역 스코프에 위치하고 있고 b함수는 c함수 내부 스코프에 위치한다.<br/>
때문에 가장 상위의 전역 스코프에서 c함수 내부에 있는 b함수를 호출하려 하면 에러가 발생한다.


### 렉시컬 스코프
스코프는 함수를 호출할 때가 아니라 선언할 때 생긴다<br/>
함수를 처음 선언하는 순간, 함수 내부의 변수는 자기 스코프로부터 가장 가까운 곳에 있는 변수를 계속 참조하게 된다.<br/>
위와 같은 스코프는 한번 선언되고 바뀌지 않기 때문에 렉시컬 스코프라고 한다. (정적 스코프)

```js
var x = 'x';
function b() {
  console.log(name); // x
}

function a() {
  var x = 'y';
  b();
}
a();
```
위 예시에서 console.log()에 x가 찍히는 이유는 선언되는 시점에서 함수 b는 가장 가까운 x라는 변수를 참조하기 때문이다.

## 즉시 실행 함수

### 전역 변수를 지양하는 이유
여러명이서 작업하거나 라이브러리를 사용하다보면 변수가 섞이는 일이 발생할 수 있다.

### 네임 스페이스 (namespace)
전역 변수 대신 객체 안에 넣어 지역변수로 만들어 사용한다.

```js
var obj = {
  x: 'local',
  y() {
    alert(this.x);
  }
}
```

위와 같이 사용하게 되면 obj.x 또는 obj.y()와 같이 접근해야하므로 다른 사람 또는 라이브러리의 변수와 섞이는 일을 예방할 수 있다.<br/>
하지만 위 방법은 비공개 변수를 만들 수 없어 obj.x = 'hacked'와 같은 코드 한줄을 추가하면 y함수를 호출했을때 알럿을 수정할 수 있다.<br/>

### iife (즉시 호출 함수 표현식 또는 모듈 패턴)

```js
var newScope = (function () {
  var x = 'local';
  return {
    y: function() {
      alert(x);
    }
  };
})();
```

위와 같이 함수 내부에 지역변수를 선언하고 외부에서 사용될 메소드 또는 프로퍼티를 객체에 포함시켜 return하면 포함되지 않은 프로퍼티 또는 메소드에는 접근이 불가능하다.<br/>
class 구문의 private메소드와 같은 효과를 낼 수 있다.